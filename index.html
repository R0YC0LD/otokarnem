<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OtoServis Pro - Dijital Araç Karnesi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="toast-container"></div>

    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo">
                <i class="fa-solid fa-shield-halved"></i> OtoServis<span>Pro</span>
            </div>
            <div class="nav-links">
                <span id="user-display" class="hidden">Hoşgeldin, Kullanıcı</span>
                <button id="logout-btn" class="btn btn-danger hidden"><i class="fa-solid fa-right-from-bracket"></i> Çıkış</button>
            </div>
        </div>
    </nav>

    <div class="main-container">

        <section id="view-login" class="view active">
            <div class="auth-box">
                <div class="auth-header">
                    <h2>Giriş Yap</h2>
                    <p>Araç geçmişinize veya servis panelinize erişin.</p>
                </div>
                <form id="login-form">
                    <div class="form-group">
                        <label>TC Kimlik No veya Kullanıcı ID</label>
                        <div class="input-icon">
                            <i class="fa-solid fa-id-card"></i>
                            <input type="text" id="login-id" placeholder="11 Haneli TC veya Usta ID" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Şifre</label>
                        <div class="input-icon">
                            <i class="fa-solid fa-lock"></i>
                            <input type="password" id="login-pass" placeholder="Şifreniz" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Giriş Yap</button>
                </form>
                <div class="auth-footer">
                    Hesabınız yok mu? <a href="#" onclick="app.router('register')">Hemen Kayıt Ol</a>
                </div>
            </div>
        </section>

        <section id="view-register" class="view hidden">
            <div class="auth-box wide">
                <div class="auth-header">
                    <h2>Yeni Üyelik</h2>
                    <p>Aracınızı sisteme kaydedin, değerini koruyun.</p>
                </div>
                <form id="register-form">
                    <div class="row">
                        <div class="col">
                            <h4>Kişisel Bilgiler</h4>
                            <div class="form-group">
                                <label>Ad Soyad</label>
                                <input type="text" id="reg-name" required>
                            </div>
                            <div class="form-group">
                                <label>TC Kimlik No</label>
                                <input type="text" id="reg-tc" maxlength="11" required>
                                <small>Giriş yapmak için kullanılacaktır.</small>
                            </div>
                            <div class="form-group">
                                <label>Şifre Belirle</label>
                                <input type="password" id="reg-pass" required>
                            </div>
                        </div>
                        <div class="col">
                            <h4>Araç Bilgileri</h4>
                            <div class="form-group">
                                <label>Plaka</label>
                                <input type="text" id="reg-plate" placeholder="34ABC123" required style="text-transform: uppercase;">
                            </div>
                            <div class="form-group">
                                <label>Şasi Numarası (VIN)</label>
                                <input type="text" id="reg-vin" required style="text-transform: uppercase;">
                            </div>
                            <div class="form-group">
                                <label>Marka / Model</label>
                                <input type="text" id="reg-model" placeholder="Örn: Fiat Egea 2021" required>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success btn-block mt-2">Kayıt Ol ve Giriş Yap</button>
                </form>
                <div class="auth-footer">
                    Zaten hesabınız var mı? <a href="#" onclick="app.router('login')">Giriş Yap</a>
                </div>
            </div>
        </section>

        <section id="view-user-dashboard" class="view hidden">
            <div class="dashboard-header">
                <div>
                    <h1>Aracım</h1>
                    <p id="user-car-detail" class="text-muted">Yükleniyor...</p>
                </div>
                <div class="qr-box">
                    <div id="qrcode"></div>
                    <small>Servis QR Kodu</small>
                </div>
            </div>

            <div class="content-card">
                <h3><i class="fa-solid fa-clock-rotate-left"></i> Servis Geçmişi</h3>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Servis / Usta</th>
                                <th>İşlem (KM)</th>
                                <th>Açıklama</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody id="user-history-body">
                            </tbody>
                    </table>
                </div>
                <div id="user-empty-state" class="empty-state hidden">
                    <i class="fa-solid fa-folder-open"></i>
                    <p>Henüz kayıtlı bir servis işleminiz yok.</p>
                </div>
            </div>
        </section>

        <section id="view-master-dashboard" class="view hidden">
            <div class="dashboard-header">
                <div>
                    <h1>Usta Paneli</h1>
                    <p>Yeni servis kaydı girin veya geçmişi sorgulayın.</p>
                </div>
                <div class="stats-box">
                    <div class="stat-item">
                        <span id="master-rating" class="stat-val">0.0</span>
                        <span class="stat-label">Ort. Puan</span>
                    </div>
                    <div class="stat-item">
                        <span id="master-count" class="stat-val">0</span>
                        <span class="stat-label">İşlem</span>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="content-card">
                        <h3><i class="fa-solid fa-plus-circle"></i> Yeni İşlem Ekle</h3>
                        <form id="service-add-form">
                            <div class="form-group">
                                <label>Müşteri Plakası</label>
                                <div class="search-wrapper">
                                    <input type="text" id="serv-plate" placeholder="34ABC123" required style="text-transform: uppercase;">
                                    <button type="button" class="btn-icon" onclick="app.checkPlate()"><i class="fa-solid fa-magnifying-glass"></i></button>
                                </div>
                                <small id="plate-status" class="status-text"></small>
                            </div>
                            
                            <div class="row-smart">
                                <div class="form-group">
                                    <label>Kilometre</label>
                                    <input type="number" id="serv-km" placeholder="Örn: 120000" required>
                                </div>
                                <div class="form-group">
                                    <label>İşlem Tarihi</label>
                                    <input type="date" id="serv-date" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Yapılan İşlemler</label>
                                <textarea id="serv-desc" rows="4" placeholder="Detaylı parça ve işçilik bilgisi..." required></textarea>
                            </div>

                            <button type="submit" class="btn btn-primary btn-block">Kaydı İşle</button>
                        </form>
                    </div>
                </div>

                <div class="col">
                    <div class="content-card">
                        <h3><i class="fa-solid fa-list-check"></i> Son Yaptığım İşlemler</h3>
                        <ul class="recent-list" id="master-recent-list">
                            </ul>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <div id="modal-rate" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal" onclick="app.closeModal()">&times;</span>
            <h3>Hizmeti Değerlendir</h3>
            <p>Aldığınız hizmeti puanlayın ve yorum yapın.</p>
            <div class="star-rating">
                <i class="fa-regular fa-star" data-val="1"></i>
                <i class="fa-regular fa-star" data-val="2"></i>
                <i class="fa-regular fa-star" data-val="3"></i>
                <i class="fa-regular fa-star" data-val="4"></i>
                <i class="fa-regular fa-star" data-val="5"></i>
            </div>
            <textarea id="rate-comment" placeholder="Yorumunuz..." class="mt-2"></textarea>
            <button id="btn-submit-rate" class="btn btn-success btn-block mt-2">Gönder</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
